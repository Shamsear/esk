<!DOCTYPE html>
<html lang="en">
<head>
    <!-- PWA support -->
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#3498db">
    <link rel="apple-touch-icon" href="/assets/images/icon-192x192.png">

    <!-- DNS prefetch and preconnect -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700;800&display=swap" media="print" onload="this.media='all'" crossorigin>
    <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700;800&display=swap"></noscript>
    <link rel="dns-prefetch" href="https://cdnjs.cloudflare.com">
    <link rel="dns-prefetch" href="https://assets.mixkit.co">
    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
    <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <title>R2G Player Data</title>
    <link rel="icon" type="image/x-icon" href="logo12.webp">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" media="print" onload="this.media='all'" crossorigin>
    <noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"></noscript>
    <!-- Include Font Awesome for icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

    <style>
        /* Main page style */
        body {
            font-family: Arial, Helvetica, sans-serif;
            background-color: #1a1a1a;
            color: #e3e3e3;
            margin: 0;
            padding: 0;
            user-select: none; /* Standard property */
            -webkit-user-select: none; /* Safari */
            -ms-user-select: none; /* Internet Explorer/Edge */
        }
        /* Welcome screen styles */
        #loading {
            position: fixed;
            width: 100%;
            height: 100%;
            background-color: #121212; /* Dark theme background */
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            color: #fff;
            text-align: center;
            font-size: 32px;
            flex-direction: column;
            animation: fadeIn 1s ease-in-out; /* Fade in effect */
        }
        /* Welcome message styling */
        .welcome-message {
            font-size: 48px;
            font-weight: bold;
            color: #b0b0b0; /* Dark gray color for the welcome message */
            opacity: 0;
            animation: fadeIn 2s ease-in-out forwards, bounce 2s ease-in-out infinite;
        }
        @media screen and (max-width: 768px) {
            .welcome-message {
            font-size: 38px;
            font-weight: bold;
            color: #b0b0b0; /* Dark gray color for the welcome message */
            opacity: 0;
            animation: fadeIn 2s ease-in-out forwards, bounce 2s ease-in-out infinite;
        }
    }

        /* Dynamic subtext that rotates */
        .subtext {
            margin-top: 20px;
            font-size: 24px;
            color: #888; /* Light gray for the loading message */
            opacity: 0;
            animation: fadeIn 2.5s ease-in-out forwards;
        }

        /* Background animation */
        .background-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #1c1c1c, #2a2a2a, #0f0f0f); /* Dark gradient */
            background-size: 300% 300%;
            animation: gradientShift 5s ease infinite;
            z-index: -1; /* Make sure it's behind the welcome screen */
        }

        /* Keyframes for fading in and background animation */
        @keyframes fadeIn {
            0% { opacity: 0; }
            100% { opacity: 1; }
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        #content {
            display: none; /* Make sure it's hidden by default */
            opacity: 0;
            animation: fadeIn 1s ease-in-out forwards;
        }

        h1 {
            text-align: center;
            font-size: 24px;
            margin-top: 20px;
            color: #fff;
        }
        h2 {
            display: block;
            font-size: 1.5em;
            margin-block-start: 0.83em;
            margin-block-end: 0.83em;
            margin-inline-start: 0px;
            margin-inline-end: 0px;
            font-weight: normal;
            unicode-bidi: isolate;
        }

        /* Search bar and filters container */
        .search-container {
            display: flex;
            justify-content: center;
            padding: 20px;
            background-color: #282828;
        }

        .search-container input {
            width: 300px;
            padding: 10px;
            border-radius: 5px;
            border: none;
            font-size: 16px;
        }

        /* Player cards section */
        .content {
            display: flex;
            padding: 20px;
            gap: 20px;
        }
        .player-cards {
             /* Ensures padding does not cause overflow */
        }

        /* Player card container with fixed dimensions */
.player-card {
    width: 250px; /* Fixed width for player cards */
    height: auto; /* Fixed height for player cards */
    background-color: transparent;
    border: none;
    padding: 0;
    text-align: center;
    box-shadow: none;
    cursor: pointer;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
    display: flex; /* Use flexbox to center content */
    flex-direction: column; /* Arrange content vertically */
    justify-content: center; /* Center vertically */
}
.player-card {
    width: 100%;
    box-sizing: border-box; /* Ensures that padding/margins don't cause overflow */
}

@media screen and (min-width: 768px) {
    .player-cards {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 20px;
        max-width: 70%;
        margin: 0 auto;
        padding: 10px;
        box-sizing: border-box;
    }
}

/* Adjust grid layout for larger screens */
@media screen and (max-width: 768px) {
    .player-cards {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 20px;
        max-width: 100%;
        margin: 0 auto;
        padding: 10px;
        box-sizing: border-box;
    }
}

        .player-item:hover {
            transform: scale(1.05);
        }

        .player-card.selected {
            border: 2px solid #4caf50;
            box-shadow: 0 0 10px rgba(76, 175, 80, 0.7);
            border-radius: 10px;
        }

        .player-card img {
            width: 100%;
            height: auto; /* Maintain aspect ratio */
            object-fit: cover;
            border-radius: 10px;
            display: block;
        }

        /* Filter section */
        .filters {
            flex: 1;
            background-color: #282828;
            padding: 20px;
            border-radius: 10px;
            color: #fff;
        }
        
        .dropdown-option img {
            width: 20px;
            height: 20px;
            margin-right: 10px;
        }

        .filters h2 {
            font-size: 20px;
            margin-bottom: 15px;
            color: #fff;
        }

        .filters label {
            font-size: 16px;
            display: block;
            margin-bottom: 10px;
        }

        .filters select {
            width: 100%;
            padding: 10px;
            margin-bottom: 20px;
            border-radius: 5px;
            background-color: #444;
            color: #fff;
            border: none;
        }

        /* Apply and Reset buttons */
        .filters .filter-buttons {
            display: flex;
            justify-content: space-between;
        }

        .filters button {
            padding: 10px 15px;
            font-size: 14px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        .search-positions a.selected {
            background-color: #4caf50;
            color: white;
        }
                
        .apply-button {
            background-color: #4caf50;
            color: #fff;
        }

        .reset-button {
            background-color: #f44336;
            color: #fff;
        }

        /* Filter Button for Mobile/Tablets */
        /* Filter Button for Mobile/Tablets */
.filter-btn {
    display: none;
    background-color: #282828;
    color: #e3e3e3;
    border: 1px solid #e3e3e3;
    padding: 10px 20px;
    font-size: 16px;
    border-radius: 20px;
    cursor: pointer;
    width: auto;
    position: fixed; /* Keep the button fixed */
    right: 20px; /* Position it on the right side */
    top: 50%; /* Position it in the middle vertically */
    transform: translateY(-50%); /* Center it vertically */
    z-index: 100; /* Ensure it stays on top */
}


        .filter-btn i {
            margin-right: 10px;
        }

        /* The Modal (background) */
.modal {
    display: none; /* Hidden by default */
    position: fixed; /* Stay in place */
    z-index: 1; /* Sit on top */
    left: 0;
    top: 0;
    width: 100%; /* Full width */
    height: 100%; /* Full height */
    background-color: rgba(0, 0, 0, 0.5); /* Black background with opacity */
    overflow: auto; /* Allow scrolling if needed */
}

/* Modal Content (The Box) */
.modal-content {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%); /* Center the modal */
    background-color: #1a1a1a;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.2);
    width: 90vw; /* 90% of the viewport width */
    max-width: 600px; /* Limit the maximum width for larger screens */
    max-height: 90vh; /* 90% of the viewport height */
    overflow-y: auto; /* Scrollable content if it exceeds height */
    box-sizing: border-box; /* Ensure padding doesn't affect width */
}

/* Modal Close Button */
.modal-content .close {
    color:white;
    float: right;
    font-size: 28px;
    font-weight: bold;
}

.modal-content .close:hover,
.modal-content .close:focus {
    color: black;
    text-decoration: none;
    cursor: pointer;
}


/* Player Info and Stats Table */
.modal-content table {
    width: 100%; /* Full width */
    border-collapse: collapse; /* Remove space between table borders */
    margin-top: 20px;
}

.modal-content table th, .modal-content table td {
    border: 1px solid white;
    padding: 8px;
    text-align: left;
}

.modal-content table th {
    background-color: white;
    font-weight: bold;
}

/* Responsive Adjustments with Media Queries */
@media (max-width: 700px) {
    .modal-content {
        width: 95vw; /* Use more of the viewport width on small screens */
        max-width: 95vw; /* Override max-width for small devices */
    }
    
    .modal-content img {
        height: auto !important; /* Reduce the image size on smaller devices */
        margin: auto;
        width: 50% !important;
        display: block;
    }
}
@media (min-width: 700px) {
    .modal-content img {
        height: auto !important; /* Reduce the image size on smaller devices */
        margin: auto;
        width: 50% !important;
        display: block;
    }
}


        .modal-content h2 {
            margin-top: 0;
            font-size: 18px;
            color: #fff;
            text-align: center;
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
        }

        .close:hover,
        .close:focus {
            color: white;
            text-decoration: none;
        }

        .filter-group {
            margin-bottom: 15px;
        }

        .filter-group label {
            display: block;
            margin-bottom: 5px;
            font-size: 14px;
        }

        .filter-group select {
            width: 100%;
            padding: 8px;
            background: #333;
            color: #fff;
            border: none;
            border-radius: 5px;
            font-size: 14px;
        }

        .filter-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }

        .apply-button {
            background-color: #bada55;
            color: #000;
            padding: 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            width: 48%;
        }

        .reset-button {
            background-color: #444;
            color: #e3e3e3;
            padding: 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            width: 48%;
        }

        .apply-button:hover {
            background-color: #a5d84b;
        }

        .reset-button:hover {
            background-color: #555;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideIn {
            from { transform: translateY(-50px); }
            to { transform: translateY(0); }
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .close:hover,
        .close:focus {
            color: white;
            text-decoration: none;
        }

        .modal h2 {
            margin-top: 0;
        }

        /* Responsive Design */
        @media screen and (max-width: 768px) {
            /* Hide filters and show the filter button on smaller screens */
            .filters {
                display: none;
            }

            .filter-btn {
                display: block;
            }
        }

        /* Improved Button UI */
        button:hover {
            opacity: 0.9;
        }
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 20px 0;
            gap: 10px;
        }
        
        .pagination button {
            background-color: #444;
            color: #e3e3e3;
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        
        .pagination button:hover {
            background-color: #555;
        }
        
        #page-info {
            color: #e3e3e3;
        }
        .search-positions {
            justify-content: center;
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-bottom: 15px;
        }
        .search-positions.b {
            justify-content: center;
            display: block;
            flex-wrap: wrap;
            gap: 5px;
            margin-bottom: 15px;
        }
        .search-positions-header {
            flex: 0 0 100%;
            margin-bottom: 5px;
        }
        .search-positions a {
            flex: 0 0 85px;
        }
        @media screen and (max-width: 768px) {
        .search-positions a {
            flex: 0 0 100px;
        }
    }
        .search-button {
            display: block;
            background: #333a3c;
            text-align: center;
            color: rgba(255, 255, 255, 0.87);
            border: 1px solid #333a3c;
            border-radius: 6px;
            font-size: 14px;
            padding-top: 5px;
            padding-bottom: 5px;
        }

        .search-button.b {
            display: block;
            background: #333a3c;
            text-align: center;
            color: rgba(255, 255, 255, 0.87);
            border: 1px solid #333a3c;
            border-radius: 6px;
            font-size: 14px;
            padding-top: 5px;
            padding-bottom: 5px;
        }
        .filters hr {
            width: 80%;
            margin-left: auto;
            margin-right: auto;
            border-bottom: 1px solid rgba(255, 255, 255, 0.08);
            margin-bottom: 20px;
            margin-top: 0%;
        }
        .logo-search-container {
            display: flex;
            flex-direction: column; /* Stack items vertically */
            align-items: center;
            margin: auto;
        }
        .logo {
            display: flex;
            justify-content: center;
        }
        
        .logo-img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin: auto; /* Adds space between logo and search bar */
        }
        .custom-dropdown {
            position: relative;
            display: inline-block;
            width: 96%;
            cursor: pointer;
            border-radius: 5px;
            padding: 10px;
            margin-bottom: 20px;
            background-color: #444;
            color: #fff;
        }
        
        .selected-option {
            display: flex;
            align-items: center;
            justify-content: left; /* Space between text and icon */
            font-size: 16px;
            padding-right: 30px; /* Space for the icon */
            position: relative;
        }
        
        .dropdown-icon {
            position: absolute;
            right: 10px; /* Position the icon to the right */
            font-size: 14px;
            color: #fff;
            top:10px;
        }
        
        
        
        .dropdown-options {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            width: 100%;
            background: #282828;
            border: 1px solid #ccc;
            z-index: 1000;
            border-radius: 5px;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .dropdown-item {
            padding: 10px;
            display: flex;
            align-items: center;
            cursor: pointer;
            color: #fff;
        }
        
        .dropdown-item img {
            width: 20px;
            height: 20px;
            margin-right: 10px;
            object-fit:contain;
        }
        @media screen and (max-width: 768px) {
            .dropdown-item img {
            width: 20px !important;
            height: 20px !important;
            margin-right: 5px !important;
            margin-left: 20px;
            margin: 0px !important;
            object-fit: contain;
        }
        .selected-option img{
            width: 20% !important;
            margin-left: 10px;
            margin-right: 10px;
            object-fit:contain;
        }
            .selected-option {
            display: flex;
            justify-content: left; /* Space between text and icon */
            font-size: 16px;
            padding-right: 30px; /* Space for the icon */
            position: relative;
            object-fit: contain;  
        }
    }
        
        .dropdown-item:hover {
            background-color: #555;
        }
        .selected-option img{
            width: 10%;
            object-fit:contain;
        }
        #playerStatsTable {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        #playerStatsTable th, #playerStatsTable td {
            border: 1px solid white;
            padding: 8px;
            text-align: center;
        }
        
        #playerStatsTable th {
            background-color: #1a1a1a;
            font-weight: bold;
        }
        
        #playerStatsTable tr:nth-child(even) {
            background-color: #1a1a1a;
        }
        
        #playerStatsTable tr:hover {
            background-color: #1a1a1a;
        }
        
        /* Admin link styling */
        .admin-link {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 100;
        }
        
        .admin-link a {
            background-color: #282828;
            color: #e3e3e3;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            text-decoration: none;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
        }
        
        .admin-link a:hover {
            background-color: #4caf50;
            transform: scale(1.1);
        }
        
        .admin-link i {
            font-size: 20px;
        }

        .player-card img {
            width: 100%;
            height: auto; /* Maintain aspect ratio */
            object-fit: cover;
            border-radius: 10px;
            display: block;
        }
        
        
        
    </style>

    <!-- Performance optimized CSS -->
    <link rel="stylesheet" href="css/performance.css" media="print" onload="this.media='all'">
    <noscript><link rel="stylesheet" href="css/performance.css"></noscript>

</head>
<body>
    <!-- Admin link -->
    <div class="admin-link">
        <a href="admin-login.html" title="Admin Panel">
            <i class="fas fa-user-shield"></i>
        </a>
    </div>
    
    <div id="loading">
        <div class="background-animation"></div> <!-- Animated background -->

        <div class="welcome-message" id="dynamic-message">Welcome to R2G Player Data</div>
        <div class="subtext" id="subtext">Loading, please wait...</div>
    </div>

    <!-- Title -->
    <header class="header">
        <div class="logo-search-container">
            <div class="logo">
                <!-- Add your logo here -->
                <img src="../assets/images/logo11.png" alt="Logo" class="logo-img" width="300" height="200">
                <h1>R2G Player Data</h1>
            </div>

    </div>
<!-- Search bar -->
<div class="search-container">
    <input type="text" id="search-bar" placeholder="Search Players...">
</div>


    <!-- Filter Button for Mobile/Tablets -->
 <!-- Filter Button for Mobile/Tablets -->
 <button class="filter-btn" onclick="openFilterModal()">
    <i class="fas fa-filter"></i> Filters
</button>
    <!-- Main content -->
    <div class="content">    
        <!-- Player cards -->
        <div class="player-cards" id="player-cards">
            <!-- Player cards will be dynamically loaded here -->
        </div>

        <!-- Filters Section -->
        <div class="filters">
            <h2>Filters</h2>
            <!-- Custom Dropdown for Star Filter -->
    <label for="star">Card Type:</label>
    <div class="custom-dropdown" id="starDropdown">
        <div class="selected-option" data-value="all">All</div>
                <i class="dropdown-icon fa fa-chevron-down"></i> 
                <div class="dropdown-options">
                    <div class="dropdown-item" data-value="all">All</div>
                    <div class="dropdown-item" data-value="3-star-standard">
                        <img src="../assets/images/players/modal/4STAR.webp" alt="3 Star Standard" width="300" height="200" loading="lazy"> 3 Star Standard
                    </div>
                    <div class="dropdown-item" data-value="4-star-standard">
                        <img src="../assets/images/players/modal/4STAR.webp" alt="4 Star Standard" width="300" height="200" loading="lazy"> 4 Star Standard
                    </div>
                    <div class="dropdown-item" data-value="5-star-standard">
                        <img src="../assets/images/players/modal/5STAR.webp" alt="5 Star Standard" width="300" height="200" loading="lazy"> 5 Star Standard
                    </div>
                    <div class="dropdown-item" data-value="4-star-legend">
                        <img src="../assets/images/players/modal/3STARLEGEND.webp" alt="4 Star Legend" width="300" height="200" loading="lazy"> 4 Star Legend
                    </div>
                    <div class="dropdown-item" data-value="5-star-legend">
                        <img src="../assets/images/players/modal/5STARLEGEND.webp" alt="5 Star Legend" width="300" height="200" loading="lazy"> 5 Star Legend
                    </div>
                </div>
    </div>
            <label for="club">Club:</label>
            <div class="custom-dropdown" id="clubDropdown">
                <div class="selected-option">All</div>
                <i class="dropdown-icon fa fa-chevron-down"></i>
                <div class="dropdown-options">
                    <div class="dropdown-item" data-value="ALL">All</div>
                    <div class="dropdown-item" data-value="FREE AGENT">
                        <img src="../assets/images/players/FREEAGENT.webp" alt="" width="300" height="200" loading="lazy"> Free Agent
                    </div>                    
                    <div class="dropdown-item" data-value="AC MILAN">
                        <img src="../assets/images/players/club/AC Milan.webp" alt="" width="300" height="200" loading="lazy"> AC Milan
                    </div>
                    <div class="dropdown-item" data-value="AFC AJAX">
                        <img src="../assets/images/players/club/AFC Ajax.webp" alt="" width="300" height="200" loading="lazy"> AFC Ajax
                    </div>
                    <div class="dropdown-item" data-value="AL HILAL SFC">
                        <img src="../assets/images/players/club/Al Hilal SFC.webp" alt="" width="300" height="200" loading="lazy"> Al Hilal SFC
                    </div>
                    <div class="dropdown-item" data-value="AL-NASSR FC">
                        <img src="../assets/images/players/club/AL-NASSR FC.webp" alt="" width="300" height="200" loading="lazy"> Al-Nassr FC
                    </div>
                    <div class="dropdown-item" data-value="ARSENAL FC">
                        <img src="../assets/images/players/club/Arsenal FC.webp" alt="" width="300" height="200" loading="lazy"> Arsenal FC
                    </div>
                    <div class="dropdown-item" data-value="AS ROMA">
                        <img src="../assets/images/players/club/AS ROMA.webp" alt="" width="300" height="200" loading="lazy"> AS Roma
                    </div>
                    <div class="dropdown-item" data-value="ASTON VILLA FC">
                        <img src="../assets/images/players/club/Aston Villa FC.webp" alt="" width="300" height="200" loading="lazy"> Aston Villa FC
                    </div>
                    <div class="dropdown-item" data-value="ATALANTA BC">
                        <img src="../assets/images/players/club/Atalanta BC.webp" alt="" width="300" height="200" loading="lazy"> Atalanta BC
                    </div>
                    <div class="dropdown-item" data-value="ATLETICO DE MADRID">
                        <img src="../assets/images/players/club/Atletico de Madrid.webp" alt="" width="300" height="200" loading="lazy"> Atletico de Madrid
                    </div>
                    <div class="dropdown-item" data-value="BAYER LEVERKUSEN">
                        <img src="../assets/images/players/club/Bayer Leverkusen.webp" alt="" width="300" height="200" loading="lazy"> Bayer Leverkusen
                    </div>
                    <div class="dropdown-item" data-value="BORUSSIA DORTMUND">
                        <img src="../assets/images/players/club/Borussia Dortmund.webp" alt="" width="300" height="200" loading="lazy"> Borussia Dortmund
                    </div>
                    <div class="dropdown-item" data-value="CHELSEA FC">
                        <img src="../assets/images/players/club/Chelsea FC.webp" alt="" width="300" height="200" loading="lazy"> Chelsea FC
                    </div>
                    <div class="dropdown-item" data-value="FC BARCELONA">
                        <img src="../assets/images/players/club/FC Barcelona.webp" alt="" width="300" height="200" loading="lazy"> FC Barcelona
                    </div>
                    <div class="dropdown-item" data-value="FC BAYERN MUNICH">
                        <img src="../assets/images/players/club/FC Bayern Munich.webp" alt="" width="300" height="200" loading="lazy"> FC Bayern Munich
                    </div>
                    <div class="dropdown-item" data-value="FC PORTO">
                        <img src="../assets/images/players/club/FC Porto.webp" alt="" width="300" height="200" loading="lazy"> FC Porto
                    </div>
                    <div class="dropdown-item" data-value="FSV MAINZ 05">
                        <img src="../assets/images/players/club/FSV Mainz 05.webp" alt="" width="300" height="200" loading="lazy"> FSV Mainz 05
                    </div>
                    <div class="dropdown-item" data-value="INTER MIAMI">
                        <img src="../assets/images/players/club/Inter Miami.webp" alt="" width="300" height="200" loading="lazy"> Inter Miami
                    </div>
                    <div class="dropdown-item" data-value="INTER MILAN">
                        <img src="../assets/images/players/club/Inter Milan.webp" alt="" width="300" height="200" loading="lazy"> Inter Milan
                    </div>
                    <div class="dropdown-item" data-value="LIVERPOOL FC">
                        <img src="../assets/images/players/club/Liverpool FC.webp" alt="" width="300" height="200" loading="lazy"> Liverpool FC
                    </div>
                    <div class="dropdown-item" data-value="LOSC LILLE">
                        <img src="../assets/images/players/club/LOSC Lille.webp" alt="" width="300" height="200" loading="lazy"> LOSC Lille
                    </div>
                    <div class="dropdown-item" data-value="MANCHESTER CITY">
                        <img src="../assets/images/players/club/Manchester City FC.webp" alt="" width="300" height="200" loading="lazy"> Manchester City FC
                    </div>
                    <div class="dropdown-item" data-value="MANCHESTER UNITED">
                        <img src="../assets/images/players/club/Manchester United FC.webp" alt="" width="300" height="200" loading="lazy"> Manchester United FC
                    </div>
                    
                    <div class="dropdown-item" data-value="MUMBAI CITY FC">
                        <img src="../assets/images/players/club/MUMBAI CITY FC.webp" alt="" width="300" height="200" loading="lazy"> Mumbai City FC
                    </div>
                    <div class="dropdown-item" data-value="NEWCASTLE UNITED FC">
                        <img src="../assets/images/players/club/Newcastle United FC.webp" alt="" width="300" height="200" loading="lazy"> Newcastle United FC
                    </div>
                    <div class="dropdown-item" data-value="PARIS SAINT-GERMAIN FC">
                        <img src="../assets/images/players/club/Paris Saint-Germain FC.webp" alt="" width="300" height="200" loading="lazy"> Paris Saint-Germain FC
                    </div>
                    <div class="dropdown-item" data-value="RANDERS FC">
                        <img src="../assets/images/players/club/Randers FC.webp" alt="" width="300" height="200" loading="lazy"> Randers FC
                    </div>
                    <div class="dropdown-item" data-value="RANGERS FC">
                        <img src="../assets/images/players/club/Rangers FC.webp" alt="" width="300" height="200" loading="lazy"> Rangers FC
                    </div>
                    <div class="dropdown-item" data-value="RB LEIPZIG">
                        <img src="../assets/images/players/club/RB Leipzig.webp" alt="" width="300" height="200" loading="lazy"> RB Leipzig
                    </div>
                    <div class="dropdown-item" data-value="REAL MADRID CF">
                        <img src="../assets/images/players/club/Real Madrid CF.webp" alt="" width="300" height="200" loading="lazy"> Real Madrid CF
                    </div>
                    
                    <div class="dropdown-item" data-value="SEPAHAN SC">
                        <img src="../assets/images/players/club/Sepahan SC.webp" alt="" width="300" height="200" loading="lazy"> Sepahan SC
                    </div>
                    <div class="dropdown-item" data-value="SL BENFICA">
                        <img src="../assets/images/players/club/SL Benfica.webp" alt="" width="300" height="200" loading="lazy"> SL Benfica
                    </div>
                    <div class="dropdown-item" data-value="SS LAZIO">
                        <img src="../assets/images/players/club/SS Lazio.webp" alt="" width="300" height="200" loading="lazy"> SS Lazio
                    </div>
                    <div class="dropdown-item" data-value="TOTTENHAM HOTSPUR FC">
                        <img src="../assets/images/players/club/Tottenham Hotspur FC.webp" alt="" width="300" height="200" loading="lazy"> Tottenham Hotspur FC
                    </div>
                    <div class="dropdown-item" data-value="VFL WOLFSBURG">
                        <img src="../assets/images/players/club/VfL Wolfsburg.webp" alt="" width="300" height="200" loading="lazy"> VfL Wolfsburg
                    </div>
                    <div class="dropdown-item" data-value="WOLVES">
                        <img src="../assets/images/players/club/Wolves.webp" alt="" width="300" height="200" loading="lazy"> Wolves
                    </div>
                </div>
            </div>
            
            <hr>
            <div class="search-positions">
                <div class="search-positions-header">
                Position:
               </div>
            <a href="Javascript:;" class="search-button.b" data-btn-type="search-positions.b" data-btn-var=""></a>
            <a href="Javascript:;" class="search-button" data-btn-type="search-positions" data-btn-var="gk">GK</a>
            <a href="Javascript:;" class="search-button.b" data-btn-type="search-positions" data-btn-var=""></a>
            <a href="Javascript:;" class="search-button" data-btn-type="search-positions" data-btn-var="lb">LB</a>
            <a href="Javascript:;" class="search-button" data-btn-type="search-positions" data-btn-var="cb">CB</a>
            <a href="Javascript:;" class="search-button" data-btn-type="search-positions" data-btn-var="rb">RB</a>
            <a href="Javascript:;" class="search-button" data-btn-type="search-positions" data-btn-var="cm">CM</a>
            <a href="Javascript:;" class="search-button" data-btn-type="search-positions" data-btn-var="am">AM</a>
            <a href="Javascript:;" class="search-button" data-btn-type="search-positions" data-btn-var="dm">DM</a>
            <a href="Javascript:;" class="search-button" data-btn-type="search-positions" data-btn-var="lw">LW</a>
            <a href="Javascript:;" class="search-button" data-btn-type="search-positions" data-btn-var="st">ST</a>
            <a href="Javascript:;" class="search-button" data-btn-type="search-positions" data-btn-var="rw">RW</a>
            </div>
            <div class="filter-buttons">
                <button class="apply-button" onclick="filterPlayers()">Apply</button>
                <button class="reset-button" onclick="resetFilters()">Reset</button>
            </div>
            
        </div>
    </div>
    
    <div id="playerModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <h2 id="modalPlayerName">Player Name</h2>
            <img id="modalPlayerPhoto" src="" alt="Player Photo" style="width:100%; height:auto; border-radius:10px; margin-bottom:20px;">
    
            <!-- Additional Player Information -->
            <p><strong>Club:</strong> <span id="modalPlayerClub"></span></p>
            <p><strong>Star Rating:</strong> <span id="modalPlayerLevel"></span></p>
            <p><strong>Position:</strong> <span id="modalPlayerPosition"></span></p>
            <p><strong>Value:</strong> <span id="modalPlayerValue"></span> RC</p>
            <!-- Player Stats Table -->
            <table id="playerStatsTable">
                <thead>
                    <tr>
                        <th>Season</th>
                        <th>Team</th>
                        <th>Value</th>
                    </tr>
                </thead>
                <tbody id="modalPlayerDetails">
                    <!-- Dynamic rows will be inserted here -->
                </tbody>
            </table>
        </div>
    </div>
    


<!-- Modal for Filters (on mobile/tablets) -->
<div id="filterModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeFilterModal()">&times;</span>
        <h2>Search Filters</h2>

        <!-- Custom Dropdown for Star Filter in Modal -->
        <div class="filter-group">
            <label for="modal-star">Card Type:</label>
            <div class="custom-dropdown" id="modalStarDropdown">
                <div class="selected-option" data-value="all">All</div>
                <i class="dropdown-icon fa fa-chevron-down"></i> 
                <div class="dropdown-options">
                    <div class="dropdown-item" data-value="all">All</div>
                    <div class="dropdown-item" data-value="3-star-standard">
                        <img src="../assets/images/players/modal/4STAR.webp" alt="3 Star Standard" width="300" height="200" loading="lazy"> 3 Star Standard
                    </div>
                    <div class="dropdown-item" data-value="4-star-standard">
                        <img src="../assets/images/players/modal/4STAR.webp" alt="4 Star Standard" width="300" height="200" loading="lazy"> 4 Star Standard
                    </div>
                    <div class="dropdown-item" data-value="5-star-standard">
                        <img src="../assets/images/players/modal/5STAR.webp" alt="5 Star Standard" width="300" height="200" loading="lazy"> 5 Star Standard
                    </div>
                    <div class="dropdown-item" data-value="4-star-legend">
                        <img src="../assets/images/players/modal/3STARLEGEND.webp" alt="4 Star Legend" width="300" height="200" loading="lazy"> 4 Star Legend
                    </div>
                    <div class="dropdown-item" data-value="5-star-legend">
                        <img src="../assets/images/players/modal/5STARLEGEND.webp" alt="5 Star Legend" width="300" height="200" loading="lazy"> 5 Star Legend
                    </div>
                </div>
            </div>

            <!-- Custom Dropdown for Club Filter in Modal -->
            <label for="modal-club">Club:</label>
            <div class="custom-dropdown" id="modalClubDropdown">
                <div class="selected-option">All</div>
                <i class="dropdown-icon fa fa-chevron-down"></i>
                <div class="dropdown-options">
                    <div class="dropdown-item" data-value="ALL">All</div>
                    <div class="dropdown-item" data-value="FREE AGENT">
                        <img src="../assets/images/players/FREEAGENT.webp" alt="" width="300" height="200" loading="lazy"> Free Agent
                    </div>                    
                    <div class="dropdown-item" data-value="AC MILAN">
                        <img src="../assets/images/players/club/AC Milan.webp" alt="" width="300" height="200" loading="lazy"> AC Milan
                    </div>
                    <div class="dropdown-item" data-value="AFC AJAX">
                        <img src="../assets/images/players/club/AFC Ajax.webp" alt="" width="300" height="200" loading="lazy"> AFC Ajax
                    </div>
                    <div class="dropdown-item" data-value="AL HILAL SFC">
                        <img src="../assets/images/players/club/Al Hilal SFC.webp" alt="" width="300" height="200" loading="lazy"> Al Hilal SFC
                    </div>
                    <div class="dropdown-item" data-value="AL-NASSR FC">
                        <img src="../assets/images/players/club/AL-NASSR FC.webp" alt="" width="300" height="200" loading="lazy"> Al-Nassr FC
                    </div>
                    <div class="dropdown-item" data-value="ARSENAL FC">
                        <img src="../assets/images/players/club/Arsenal FC.webp" alt="" width="300" height="200" loading="lazy"> Arsenal FC
                    </div>
                    <div class="dropdown-item" data-value="AS ROMA">
                        <img src="../assets/images/players/club/AS ROMA.webp" alt="" width="300" height="200" loading="lazy"> AS Roma
                    </div>
                    <div class="dropdown-item" data-value="ASTON VILLA FC">
                        <img src="../assets/images/players/club/Aston Villa FC.webp" alt="" width="300" height="200" loading="lazy"> Aston Villa FC
                    </div>
                    <div class="dropdown-item" data-value="ATALANTA BC">
                        <img src="../assets/images/players/club/Atalanta BC.webp" alt="" width="300" height="200" loading="lazy"> Atalanta BC
                    </div>
                    <div class="dropdown-item" data-value="ATLETICO DE MADRID">
                        <img src="../assets/images/players/club/Atletico de Madrid.webp" alt="" width="300" height="200" loading="lazy"> Atletico de Madrid
                    </div>
                    <div class="dropdown-item" data-value="BAYER LEVERKUSEN">
                        <img src="../assets/images/players/club/Bayer Leverkusen.webp" alt="" width="300" height="200" loading="lazy"> Bayer Leverkusen
                    </div>
                    <div class="dropdown-item" data-value="BORUSSIA DORTMUND">
                        <img src="../assets/images/players/club/Borussia Dortmund.webp" alt="" width="300" height="200" loading="lazy"> Borussia Dortmund
                    </div>
                    <div class="dropdown-item" data-value="CHELSEA FC">
                        <img src="../assets/images/players/club/Chelsea FC.webp" alt="" width="300" height="200" loading="lazy"> Chelsea FC
                    </div>
                    <div class="dropdown-item" data-value="FC BARCELONA">
                        <img src="../assets/images/players/club/FC Barcelona.webp" alt="" width="300" height="200" loading="lazy"> FC Barcelona
                    </div>
                    <div class="dropdown-item" data-value="FC BAYERN MUNICH">
                        <img src="../assets/images/players/club/FC Bayern Munich.webp" alt="" width="300" height="200" loading="lazy"> FC Bayern Munich
                    </div>
                    <div class="dropdown-item" data-value="FC PORTO">
                        <img src="../assets/images/players/club/FC Porto.webp" alt="" width="300" height="200" loading="lazy"> FC Porto
                    </div>
                    <div class="dropdown-item" data-value="FSV MAINZ 05">
                        <img src="../assets/images/players/club/FSV Mainz 05.webp" alt="" width="300" height="200" loading="lazy"> FSV Mainz 05
                    </div>
                    <div class="dropdown-item" data-value="INTER MIAMI">
                        <img src="../assets/images/players/club/Inter Miami.webp" alt="" width="300" height="200" loading="lazy"> Inter Miami
                    </div>
                    <div class="dropdown-item" data-value="INTER MILAN">
                        <img src="../assets/images/players/club/Inter Milan.webp" alt="" width="300" height="200" loading="lazy"> Inter Milan
                    </div>
                    <div class="dropdown-item" data-value="LIVERPOOL FC">
                        <img src="../assets/images/players/club/Liverpool FC.webp" alt="" width="300" height="200" loading="lazy"> Liverpool FC
                    </div>
                    <div class="dropdown-item" data-value="LOSC LILLE">
                        <img src="../assets/images/players/club/LOSC Lille.webp" alt="" width="300" height="200" loading="lazy"> LOSC Lille
                    </div>
                    <div class="dropdown-item" data-value="MANCHESTER CITY">
                        <img src="../assets/images/players/club/Manchester City FC.webp" alt="" width="300" height="200" loading="lazy"> Manchester City FC
                    </div>
                    <div class="dropdown-item" data-value="MANCHESTER UNITED">
                        <img src="../assets/images/players/club/Manchester United FC.webp" alt="" width="300" height="200" loading="lazy"> Manchester United FC
                    </div>
                    
                    <div class="dropdown-item" data-value="MUMBAI CITY FC">
                        <img src="../assets/images/players/club/MUMBAI CITY FC.webp" alt="" width="300" height="200" loading="lazy"> Mumbai City FC
                    </div>
                    <div class="dropdown-item" data-value="NEWCASTLE UNITED FC">
                        <img src="../assets/images/players/club/Newcastle United FC.webp" alt="" width="300" height="200" loading="lazy"> Newcastle United FC
                    </div>
                    <div class="dropdown-item" data-value="PARIS SAINT-GERMAIN FC">
                        <img src="../assets/images/players/club/Paris Saint-Germain FC.webp" alt="" width="300" height="200" loading="lazy"> Paris Saint-Germain FC
                    </div>
                    <div class="dropdown-item" data-value="RANDERS FC">
                        <img src="../assets/images/players/club/Randers FC.webp" alt="" width="300" height="200" loading="lazy"> Randers FC
                    </div>
                    <div class="dropdown-item" data-value="RANGERS FC">
                        <img src="../assets/images/players/club/Rangers FC.webp" alt="" width="300" height="200" loading="lazy"> Rangers FC
                    </div>
                    <div class="dropdown-item" data-value="RB LEIPZIG">
                        <img src="../assets/images/players/club/RB Leipzig.webp" alt="" width="300" height="200" loading="lazy"> RB Leipzig
                    </div>
                    <div class="dropdown-item" data-value="REAL MADRID CF">
                        <img src="../assets/images/players/club/Real Madrid CF.webp" alt="" width="300" height="200" loading="lazy"> Real Madrid CF
                    </div>
                    
                    <div class="dropdown-item" data-value="SEPAHAN SC">
                        <img src="../assets/images/players/club/Sepahan SC.webp" alt="" width="300" height="200" loading="lazy"> Sepahan SC
                    </div>
                    <div class="dropdown-item" data-value="SL BENFICA">
                        <img src="../assets/images/players/club/SL Benfica.webp" alt="" width="300" height="200" loading="lazy"> SL Benfica
                    </div>
                    <div class="dropdown-item" data-value="SS LAZIO">
                        <img src="../assets/images/players/club/SS Lazio.webp" alt="" width="300" height="200" loading="lazy"> SS Lazio
                    </div>
                    <div class="dropdown-item" data-value="TOTTENHAM HOTSPUR FC">
                        <img src="../assets/images/players/club/Tottenham Hotspur FC.webp" alt="" width="300" height="200" loading="lazy"> Tottenham Hotspur FC
                    </div>
                    <div class="dropdown-item" data-value="VFL WOLFSBURG">
                        <img src="../assets/images/players/club/VfL Wolfsburg.webp" alt="" width="300" height="200" loading="lazy"> VfL Wolfsburg
                    </div>
                    <div class="dropdown-item" data-value="WOLVES">
                        <img src="../assets/images/players/club/Wolves.webp" alt="" width="300" height="200" loading="lazy"> Wolves
                    </div>
                </div>
            </div>            
        </div>

            <div class="search-positions">
            <div class="search-positions-header">
            Position
            </div>
            <a href="Javascript:;" class="search-button.b" data-btn-type="search-positions.b" data-btn-var=""></a>
            <a href="Javascript:;" class="search-button gk" data-btn-type="search-positions" data-btn-var="gk">GK</a>
            <a href="Javascript:;" class="search-button.b" data-btn-type="search-positions" data-btn-var=""></a>
            <a href="Javascript:;" class="search-button lb" data-btn-type="search-positions" data-btn-var="lb">LB</a>
            <a href="Javascript:;" class="search-button cb" data-btn-type="search-positions" data-btn-var="cb">CB</a>
            <a href="Javascript:;" class="search-button rb" data-btn-type="search-positions" data-btn-var="rb">RB</a>
            <a href="Javascript:;" class="search-button cm" data-btn-type="search-positions" data-btn-var="cm">CM</a>
            <a href="Javascript:;" class="search-button am" data-btn-type="search-positions" data-btn-var="am">AM</a>
            <a href="Javascript:;" class="search-button dm" data-btn-type="search-positions" data-btn-var="dm">DM</a>
            <a href="Javascript:;" class="search-button lw" data-btn-type="search-positions" data-btn-var="lw">LW</a>
            <a href="Javascript:;" class="search-button st" data-btn-type="search-positions" data-btn-var="st">ST</a>
            <a href="Javascript:;" class="search-button rw" data-btn-type="search-positions" data-btn-var="rw">RW</a>
            </div>
            
        <div class="filter-buttons">
            <button class="apply-button" onclick="applyModalFilters()">Apply Filters</button>
            <button class="reset-button" onclick="resetModalFilters()">Reset Filters</button>
        </div>
    </div>
</div>
<div class="pagination">
    <button class="prev-button" onclick="prevPage()">Previous</button>
    <span id="page-info">Page 1</span>
    <button class="next-button" onclick="nextPage()">Next</button>
</div>

    <script>

window.onload = function() {
    const messages = [
        "Welcome to R2G Player Data",
        "Loading Data...",
        "Ready to Explore Players?"
    ];
    let messageIndex = 0;

    // Fetch players data from JSON file
    fetchPlayersData();

    // Cycle through messages every 1.5 seconds
    const messageInterval = setInterval(function() {
        messageIndex++;
        if (messageIndex < messages.length) {
            document.getElementById("dynamic-message").textContent = messages[messageIndex];
        } else {
            clearInterval(messageInterval); // Stop the interval once all messages have been shown
        }
    }, 1500);

    // Add a 4-second delay before hiding the welcome message and showing content
    setTimeout(function() {
        document.getElementById('loading').style.display = 'none';  // Hide the welcome screen
        document.getElementById('content').style.display = 'block';  // Show the main content
    }, 4500);  // 4000 milliseconds = 4 seconds
    resetFilters();
    resetModalFilters(); // Reset the filters when the page loads
    sortPlayers();  // Sort players when the page loads
};

// Function to fetch and load player data from the JSON file
async function fetchPlayersData() {
    try {
        // Show loading indicator with progress updates
        const loadingElement = document.getElementById('loading');
        const subtextElement = document.getElementById('subtext');
        subtextElement.textContent = 'Fetching player data...';
        
        // Fetch the data with a timeout to handle very large files
        const controller = new AbortController();
        const timeoutId = setTimeout(() => controller.abort(), 10000); // 10 second timeout
        
        const response = await fetch('players.json', {
            signal: controller.signal
        });
        clearTimeout(timeoutId);
        
        if (!response.ok) {
            throw new Error('Failed to load player data');
        }
        
        subtextElement.textContent = 'Processing player data...';
        
        // Use streaming approach for large JSON files
        const reader = response.body.getReader();
        const decoder = new TextDecoder();
        let chunks = '';
        
        // Process the data in chunks
        while(true) {
            const {value, done} = await reader.read();
            if (done) break;
            chunks += decoder.decode(value, {stream: true});
        }
        
        const players = JSON.parse(chunks);
        subtextElement.textContent = 'Preparing display...';
        
        // Initialize pagination state
        window.playerState = {
            allPlayers: players,
            filteredPlayers: [],
            currentPage: 1,
            itemsPerPage: 24,
            totalPages: 1,
            filters: {
                searchTerm: '',
                star: 'all',
                club: 'ALL',
                position: []
            }
        };
        
        // Basic pre-sorting (we'll sort filtered results as needed)
        window.playerState.allPlayers.sort((a, b) => {
            // Sort by value in descending order
            if (a.value !== b.value) {
                return b.value - a.value; // Descending order
            }
            
            // If values are the same, sort alphabetically by name
            return a.name.toLowerCase().localeCompare(b.name.toLowerCase());
        });
        
        // Apply initial filters and pagination
        applyFiltersAndDisplay();
        
        // Hide the loading screen after a short delay to ensure smooth transition
        setTimeout(function() {
            loadingElement.style.opacity = '0';
            setTimeout(function() {
                loadingElement.style.display = 'none';
                document.getElementById('content').style.display = 'block';
                document.getElementById('content').style.opacity = '1';
            }, 500);
        }, 1000);
        
    } catch (error) {
        console.error('Error loading player data:', error);
        document.getElementById('subtext').textContent = 'Error loading data. Please try again.';
    }
}

// Apply filters and display the current page
function applyFiltersAndDisplay() {
    const state = window.playerState;
    
    // Apply filters
    state.filteredPlayers = state.allPlayers.filter(player => {
        // Search filter
        const nameMatch = !state.filters.searchTerm || 
            normalizeText(player.name).includes(normalizeText(state.filters.searchTerm));
        
        // Star rating filter
        const starMatch = state.filters.star === 'all' || 
            player.star === state.filters.star;
        
        // Club filter
        const clubMatch = state.filters.club === 'ALL' || 
            player.club === state.filters.club;
        
        // Position filter
        const positionMatch = state.filters.position.length === 0 || 
            state.filters.position.includes(player.position.toLowerCase());
        
        return nameMatch && starMatch && clubMatch && positionMatch;
    });
    
    // Calculate total pages
    state.totalPages = Math.ceil(state.filteredPlayers.length / state.itemsPerPage);
    
    // Ensure current page is valid
    if (state.currentPage > state.totalPages) {
        state.currentPage = Math.max(1, state.totalPages);
    }
    
    // Display the current page
    displayCurrentPage();
    
    // Update pagination info
    updatePaginationInfo();
}

// Display current page of players
function displayCurrentPage() {
    const state = window.playerState;
    const container = document.querySelector('.player-cards');
    
    // Clear container
    container.innerHTML = '';
    
    // Calculate start and end indices
    const startIndex = (state.currentPage - 1) * state.itemsPerPage;
    const endIndex = Math.min(startIndex + state.itemsPerPage, state.filteredPlayers.length);
    
    // Only load players for current page
    const fragment = document.createDocumentFragment();
    for (let i = startIndex; i < endIndex; i++) {
        const player = state.filteredPlayers[i];
        const playerCard = createPlayerCard(player);
        fragment.appendChild(playerCard);
    }
    
    // Append all at once
    container.appendChild(fragment);
}

// Create a player card element from player data
function createPlayerCard(player) {
    const playerCard = document.createElement('div');
    playerCard.className = 'player-card';
    
    // Set data attributes
    playerCard.setAttribute('data-name', player.name);
    playerCard.setAttribute('data-star', player.star);
    playerCard.setAttribute('data-level', player.level);
    playerCard.setAttribute('data-club', player.club);
    playerCard.setAttribute('data-position', player.position);
    playerCard.setAttribute('data-value', player.value);
    playerCard.setAttribute('data-games-played', player.gamesPlayed);
    playerCard.setAttribute('data-stats', JSON.stringify(player.stats));
    
    // Create the image element
    const img = document.createElement('img');
    
    // Fix for FREE AGENT images - use a fallback path if the image doesn't exist
    if (player.club === "FREE AGENT") {
        // Use a more generic path that doesn't include FREEAGENT.webp
        img.onerror = function() {
            // If the image fails to load, try a fallback path based on the player's star rating
            if (player.star.includes('5-star-legend')) {
                this.src = "../assets/images/players/5 STAR LEGEND CARDS/default.webp";
            } else if (player.star.includes('4-star-legend')) {
                this.src = "../assets/images/players/4 STAR LEGEND CARDS/default.webp";
            } else if (player.star.includes('5-star-standard')) {
                this.src = "../assets/images/players/5 STAR CARDS/default.webp";
            } else {
                this.src = "../assets/images/players/default.webp";
            }
        };
    }
    
    img.src = player.imagePath;
    img.alt = player.name;
    img.loading = 'lazy'; // Lazy load images
    
    // Append the image to the card
    playerCard.appendChild(img);
    
    return playerCard;
}

// Helper function to normalize text for searching
function normalizeText(text) {
    // Normalize the text to NFD (Normalization Form Decomposition) and remove diacritics
    return text.normalize("NFD").replace(/[\u0300-\u036f]/g, "").toLowerCase();
}

// Custom order for positions
const positionOrder = ['gk', 'cb', 'lb', 'rb', 'dm', 'cm', 'am', 'lw', 'rw', 'st'];

function sortPlayers() {
    const playersContainer = document.querySelector('.player-cards');
    const players = Array.from(playersContainer.children);

    players.sort((a, b) => {
        // Sort by value in descending order
        const valueA = parseInt(a.getAttribute('data-value'), 10);
        const valueB = parseInt(b.getAttribute('data-value'), 10);
        
        if (valueA !== valueB) {
            return valueB - valueA; // Descending order
        }

        // If values are the same, sort alphabetically by name
        const nameA = a.getAttribute('data-name').toLowerCase();
        const nameB = b.getAttribute('data-name').toLowerCase();
        return nameA.localeCompare(nameB);
    });

    // Re-append sorted players to the container
    players.forEach(player => playersContainer.appendChild(player));
}

// Function to hide the filter button
function hideFilterButton() {
    document.querySelector('.filter-btn').style.display = 'none';
}

// Function to show the filter button
function showFilterButton() {
    document.querySelector('.filter-btn').style.display = 'block';
}

// Open the filter modal and hide the filter button
function openFilterModal() {
    document.getElementById('filterModal').style.display = 'block';
    hideFilterButton();  // Hide filter button when modal is opened
}

// Close the filter modal and show the filter button
function closeFilterModal() {
    document.getElementById('filterModal').style.display = 'none';
    showFilterButton();  // Show filter button when modal is closed
}

// Open the player modal and hide the filter button
function openModal(card) {
    const name = card.getAttribute('data-name');
    const photoSrc = card.querySelector('img').src;
    const club = card.getAttribute('data-club');
    const level = card.getAttribute('data-level');
    const position = card.getAttribute('data-position');
    const value = card.getAttribute('data-value');
    
    // Parse stats from the JSON-like data-stats attribute
    const stats = JSON.parse(card.getAttribute('data-stats'));

    // Set modal content for basic info
    document.getElementById('modalPlayerName').textContent = name;
    document.getElementById('modalPlayerPhoto').src = photoSrc;
    document.getElementById('modalPlayerClub').textContent = club;
    document.getElementById('modalPlayerLevel').textContent = level;
    document.getElementById('modalPlayerPosition').textContent = position;
    document.getElementById('modalPlayerValue').textContent = value;    
    // Clear the previous table rows
    const tableBody = document.getElementById('modalPlayerDetails');
    tableBody.innerHTML = '';

    // Populate the playerStatsTable with the player's individual stats
    stats.forEach(stat => {
        const row = document.createElement('tr');
        row.innerHTML = `
            <td>${stat.season}</td>
            <td>${stat.team}</td>
            <td>${stat.value}</td>
        `;
        tableBody.appendChild(row);
    });

    // Show the modal
    const modal = document.getElementById('playerModal');
    modal.style.display = "block";
    hideFilterButton();  // Hide filter button when player modal is opened
}

// Close the player modal and show the filter button
function closeModal() {
    const modal = document.getElementById('playerModal');
    modal.style.display = "none";
    showFilterButton();  // Show filter button when player modal is closed
}

// Modal filter functions
function resetModalFilters() {
    document.querySelector('#modalStarDropdown .selected-option').innerHTML = "All";
    document.querySelector('#modalStarDropdown .selected-option').setAttribute('data-value', "all");
    document.querySelector('#modalClubDropdown .selected-option').innerHTML = "All";
    document.querySelector('#modalClubDropdown .selected-option').setAttribute('data-value', "ALL");
    
    modalSelectedPositions = [];
    document.querySelectorAll('#filterModal .search-positions a').forEach(button => {
        button.classList.remove('selected');
    });
    
    closeFilterModal();
    resetFilters();
}

function applyModalFilters() {
    const modalStar = document.querySelector('#modalStarDropdown .selected-option').getAttribute('data-value');
    const modalClub = document.querySelector('#modalClubDropdown .selected-option').getAttribute('data-value');
    
    document.querySelector('#starDropdown .selected-option').innerHTML = document.querySelector('#modalStarDropdown .selected-option').innerHTML;
    document.querySelector('#starDropdown .selected-option').setAttribute('data-value', modalStar);
    document.querySelector('#clubDropdown .selected-option').innerHTML = document.querySelector('#modalClubDropdown .selected-option').innerHTML;
    document.querySelector('#clubDropdown .selected-option').setAttribute('data-value', modalClub);
    
    selectedPositions = [...modalSelectedPositions];
    
    document.querySelectorAll('.search-positions a').forEach(button => {
        const position = button.getAttribute('data-btn-var');
        if (selectedPositions.includes(position)) {
            button.classList.add('selected');
        } else {
            button.classList.remove('selected');
        }
    });
    
    closeFilterModal();
    filterPlayers();
}

// Update pagination info
function updatePaginationInfo() {
    const state = window.playerState;
    const pageInfo = document.getElementById('page-info');
    
    if (state.totalPages > 0) {
        pageInfo.textContent = `Page ${state.currentPage} of ${state.totalPages}`;
    } else {
        pageInfo.textContent = 'No results';
    }
    
    // Update button states
    document.querySelector('.prev-button').disabled = state.currentPage <= 1;
    document.querySelector('.next-button').disabled = state.currentPage >= state.totalPages;
}

// Navigation functions
function prevPage() {
    if (window.playerState.currentPage > 1) {
        window.playerState.currentPage--;
        displayCurrentPage();
        updatePaginationInfo();
        window.scrollTo({
            top: 0,
            behavior: 'smooth'
        });
    }
}

function nextPage() {
    if (window.playerState.currentPage < window.playerState.totalPages) {
        window.playerState.currentPage++;
        displayCurrentPage();
        updatePaginationInfo();
        window.scrollTo({
            top: 0,
            behavior: 'smooth'
        });
    }
}

// Initialize event listeners
document.addEventListener('DOMContentLoaded', function() {
    // Prevent right-clicking (optional)
    document.addEventListener('contextmenu', function(event) {
        event.preventDefault();
    });
    
    // Prevent text selection (optional)
    document.addEventListener('selectstart', function(event) {
        event.preventDefault();
    });
    
    // Set up search bar
    const searchBar = document.getElementById('search-bar');
    searchBar.addEventListener('input', function() {
        window.playerState.filters.searchTerm = this.value.toLowerCase();
        window.playerState.currentPage = 1; // Reset to first page on search
        applyFiltersAndDisplay();
    });
    
    // Set up position filters
    let selectedPositions = [];
    document.querySelectorAll('.search-positions a').forEach(button => {
        button.addEventListener('click', function() {
            const position = this.getAttribute('data-btn-var');
            
            // Toggle selection
            if (selectedPositions.includes(position)) {
                selectedPositions = selectedPositions.filter(pos => pos !== position);
                this.classList.remove('selected');
            } else {
                selectedPositions.push(position);
                this.classList.add('selected');
            }
            
            window.playerState.filters.position = selectedPositions;
            window.playerState.currentPage = 1; // Reset to first page
            applyFiltersAndDisplay();
        });
    });
    
    // Set up dropdown filters
    function setupDropdown(dropdownId) {
        const customDropdown = document.getElementById(dropdownId);
        if (!customDropdown) return;
        
        const selectedOption = customDropdown.querySelector('.selected-option');
        const dropdownOptions = customDropdown.querySelector('.dropdown-options');
        
        // Toggle the dropdown display
        selectedOption.addEventListener('click', () => {
            dropdownOptions.style.display = dropdownOptions.style.display === 'block' ? 'none' : 'block';
        });
        
        // Use event delegation for the dropdown options
        dropdownOptions.addEventListener('click', (event) => {
            const item = event.target.closest('.dropdown-item');
            if (item) {
                selectedOption.innerHTML = item.innerHTML;
                selectedOption.setAttribute('data-value', item.getAttribute('data-value'));
                dropdownOptions.style.display = 'none';
                
                // Update filters
                if (dropdownId === 'starDropdown') {
                    window.playerState.filters.star = item.getAttribute('data-value');
                } else if (dropdownId === 'clubDropdown') {
                    window.playerState.filters.club = item.getAttribute('data-value');
                }
                
                window.playerState.currentPage = 1; // Reset to first page
                applyFiltersAndDisplay();
            }
        });
        
        // Close the dropdown if clicked outside
        document.addEventListener('click', (event) => {
            if (!customDropdown.contains(event.target)) {
                dropdownOptions.style.display = 'none';
            }
        });
    }
    
    // Initialize dropdowns
    setupDropdown('starDropdown');
    setupDropdown('clubDropdown');
    setupDropdown('modalStarDropdown');
    setupDropdown('modalClubDropdown');
    
    // Set up filter buttons
    document.querySelector('.apply-button').addEventListener('click', filterPlayers);
    document.querySelector('.reset-button').addEventListener('click', resetFilters);
    
    // Set up pagination buttons
    document.querySelector('.prev-button').addEventListener('click', prevPage);
    document.querySelector('.next-button').addEventListener('click', nextPage);
    
    // Initialize player cards with click events
    document.addEventListener('click', function(e) {
        const playerCard = e.target.closest('.player-card');
        if (playerCard) {
            openModal(playerCard);
        }
    });
    
    // Start loading the data
    fetchPlayersData();
});

// Filter functions
function filterPlayers() {
    const state = window.playerState;
    
    // Get filter values from UI
    state.filters.searchTerm = document.getElementById('search-bar').value.toLowerCase();
    state.filters.star = document.querySelector('#starDropdown .selected-option').getAttribute('data-value');
    state.filters.club = document.querySelector('#clubDropdown .selected-option').getAttribute('data-value');
    state.filters.position = selectedPositions; // Global variable from existing code
    
    // Reset to first page
    state.currentPage = 1;
    
    // Apply filters and update display
    applyFiltersAndDisplay();
    
    // Scroll to top
    window.scrollTo({
        top: 0,
        behavior: 'smooth'
    });
}

// Reset filters
function resetFilters() {
    // Clear search term
    document.getElementById('search-bar').value = "";
    
    // Reset dropdowns
    document.querySelector('#starDropdown .selected-option').innerHTML = "All";
    document.querySelector('#starDropdown .selected-option').setAttribute('data-value', "all");
    document.querySelector('#clubDropdown .selected-option').innerHTML = "All";
    document.querySelector('#clubDropdown .selected-option').setAttribute('data-value', "ALL");
    
    // Reset position buttons
    selectedPositions = [];
    document.querySelectorAll('.search-positions a').forEach(button => {
        button.classList.remove('selected');
    });
    
    // Update state
    const state = window.playerState;
    state.filters.searchTerm = '';
    state.filters.star = 'all';
    state.filters.club = 'ALL';
    state.filters.position = [];
    state.currentPage = 1;
    
    // Apply filters
    applyFiltersAndDisplay();
}

    </script>


    <!-- Performance optimization JS -->
    <script>
        // Immediately executed critical JS
        document.addEventListener('DOMContentLoaded', function() {
            // Load the video after page content
            setTimeout(function() {
                const video = document.querySelector('.video-bg');
                if (video && video.dataset.src) {
                    const source = document.createElement('source');
                    source.src = video.dataset.src;
                    source.type = 'video/mp4';
                    video.appendChild(source);
                    video.load();
                    video.play().catch(e => console.log('Autoplay prevented:', e));
                }
            }, 1000);
            
            // Set fade out for preloader
            window.addEventListener('load', function() {
                const preloader = document.querySelector('.preloader');
                if (preloader) {
                    setTimeout(function() {
                        preloader.style.opacity = '0';
                        setTimeout(function() {
                            preloader.style.display = 'none';
                        }, 500);
                    }, 500);
                }
            });
        });
    </script>
    
    <!-- Load performance optimizations -->
    <script defer src="js/performance.js"></script>
    <!-- Load background scroll handling -->
    <script defer src="js/background-scroll.js"></script>
    <!-- Fix infinite scrolling -->
    <script defer src="js/fix-overflow.js"></script>

    <!-- Service worker registration -->
    <script defer src="js/sw-register.js"></script>
    
    <!-- Performance optimizations -->
    <script defer src="js/performance.js"></script>
    <script defer src="js/image-optimization.js"></script>

</body>
</html>
